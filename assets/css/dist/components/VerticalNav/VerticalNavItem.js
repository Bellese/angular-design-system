"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VerticalNavItem=void 0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_propTypes=require("prop-types"),_propTypes2=_interopRequireDefault(_propTypes),_react=require("react"),_react2=_interopRequireDefault(_react),_VerticalNav=require("./VerticalNav"),_VerticalNav2=_interopRequireDefault(_VerticalNav),_VerticalNavItemLabel=require("./VerticalNavItemLabel"),_VerticalNavItemLabel2=_interopRequireDefault(_VerticalNavItemLabel),_classnames=require("classnames"),_classnames2=_interopRequireDefault(_classnames),_lodash=require("lodash.uniqueid"),_lodash2=_interopRequireDefault(_lodash);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var VerticalNavItem=exports.VerticalNavItem=function(_React$PureComponent){function VerticalNavItem(props){_classCallCheck(this,VerticalNavItem);var _this=_possibleConstructorReturn(this,(VerticalNavItem.__proto__||Object.getPrototypeOf(VerticalNavItem)).call(this,props));return _this.handleLabelClick=_this.handleLabelClick.bind(_this),_this.id=_this.props.id||(0,_lodash2.default)("VerticalNavItem_"),_this.subnavId=_this.id+"__subnav",_this.state={collapsed:_this.props.defaultCollapsed},_this}return _inherits(VerticalNavItem,_react2.default.PureComponent),_createClass(VerticalNavItem,[{key:"componentDidUpdate",value:function componentDidUpdate(prevProps,prevState){this.props.onSubnavToggle&&prevState.collapsed!==this.state.collapsed&&this.props.onSubnavToggle(this.props.id,this.state.collapsed)}},{key:"handleLabelClick",value:function handleLabelClick(evt){return this.hasSubnav()?this.handleToggleClick():this.handleClick(evt)}},{key:"handleClick",value:function handleClick(evt){this.props.onClick&&this.props.onClick(evt,this.id,this.props.url)}},{key:"handleToggleClick",value:function handleToggleClick(){this.setState({collapsed:!this.state.collapsed})}},{key:"hasSubnav",value:function hasSubnav(){return Boolean(this.props.items&&this.props.items.length>0)}},{key:"isSelected",value:function isSelected(){return this.props.selected?this.props.selected:!(!this.props._selectedId||!this.hasSubnav())&&this.childIsSelected(this.props.items)}},{key:"childIsSelected",value:function childIsSelected(children){var _this2=this;return!(!children||!children.length)&&children.some((function(child){return child.id===_this2.props._selectedId||_this2.childIsSelected(child.items)}))}},{key:"subnavItems",value:function subnavItems(){if(this.props.url){var item=_extends({},this.props);return delete item.items,[item].concat(this.props.items)}return this.props.items}},{key:"renderSubnav",value:function renderSubnav(){if(this.hasSubnav())return _react2.default.createElement(_VerticalNav2.default,{selectedId:this.props._selectedId,collapsed:this.state.collapsed,id:this.subnavId,items:this.subnavItems(),nested:!0})}},{key:"render",value:function render(){var classes=(0,_classnames2.default)("ds-c-vertical-nav__item",this.props.className);return _react2.default.createElement("li",{className:classes},_react2.default.createElement(_VerticalNavItemLabel2.default,{ariaCollapsedStateButtonLabel:this.props.ariaCollapsedStateButtonLabel,ariaExpandedStateButtonLabel:this.props.ariaExpandedStateButtonLabel,collapsed:this.state.collapsed,label:this.props.label,hasSubnav:this.hasSubnav(),onClick:this.handleLabelClick,selected:this.isSelected(),subnavId:this.subnavId,url:this.props.url}),this.renderSubnav())}}]),VerticalNavItem}();VerticalNavItem.defaultProps={ariaCollapsedStateButtonLabel:"Expand sub-navigation",ariaExpandedStateButtonLabel:"Collapse sub-navigation",defaultCollapsed:!1},VerticalNavItem.propTypes={_selectedId:_propTypes2.default.string,ariaCollapsedStateButtonLabel:_propTypes2.default.string,ariaExpandedStateButtonLabel:_propTypes2.default.string,className:_propTypes2.default.string,defaultCollapsed:_propTypes2.default.bool,onClick:_propTypes2.default.func,onSubnavToggle:_propTypes2.default.func,id:_propTypes2.default.string,items:_propTypes2.default.arrayOf(_propTypes2.default.shape(VerticalNavItem.propTypes)),label:_propTypes2.default.node.isRequired,url:_propTypes2.default.string,selected:_propTypes2.default.bool},exports.default=VerticalNavItem;