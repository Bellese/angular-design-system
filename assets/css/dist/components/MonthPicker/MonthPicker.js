"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MonthPicker=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();exports.getMonthNames=getMonthNames,require("core-js/fn/array/includes");var _Button=require("../Button/Button"),_Button2=_interopRequireDefault(_Button),_Choice=require("../ChoiceList/Choice"),_Choice2=_interopRequireDefault(_Choice),_FormLabel=require("../FormLabel/FormLabel"),_FormLabel2=_interopRequireDefault(_FormLabel),_propTypes=require("prop-types"),_propTypes2=_interopRequireDefault(_propTypes),_react=require("react"),_react2=_interopRequireDefault(_react),_classnames=require("classnames"),_classnames2=_interopRequireDefault(_classnames),_lodash=require("lodash.uniqueid"),_lodash2=_interopRequireDefault(_lodash);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var NUM_MONTHS=12,monthNumbers=function(){for(var months=[],m=1;m<=NUM_MONTHS;m++)months.push(m);return months}(),MonthPicker=exports.MonthPicker=function(_React$PureComponent){function MonthPicker(props){_classCallCheck(this,MonthPicker);var _this=_possibleConstructorReturn(this,(MonthPicker.__proto__||Object.getPrototypeOf(MonthPicker)).call(this,props));return _this.hintId=(0,_lodash2.default)("monthpicker_hint_"),_this.labelId=(0,_lodash2.default)("monthpicker_label_"),_this.months=getMonthNames(props.locale),_this.monthsLong=getMonthNames(props.locale,!1),void 0===props.selectedMonths?(_this.isControlled=!1,_this.state={selectedMonths:props.defaultSelectedMonths||[]}):_this.isControlled=!0,_this}return _inherits(MonthPicker,_react2.default.PureComponent),_createClass(MonthPicker,[{key:"selectedMonths",value:function selectedMonths(){return this.isControlled?this.props.selectedMonths:this.state.selectedMonths}},{key:"disabledMonths",value:function disabledMonths(){return this.props.disabledMonths||[]}},{key:"handleChange",value:function handleChange(event){if(this.props.onChange&&this.props.onChange(event),!this.isControlled){var month=parseInt(event.target.value),selectedMonths=this.state.selectedMonths.slice();selectedMonths.includes(month)?selectedMonths.splice(selectedMonths.indexOf(month),1):selectedMonths.push(month),this.setState({selectedMonths:selectedMonths})}}},{key:"handleSelectAll",value:function handleSelectAll(){if(this.props.onSelectAll&&this.props.onSelectAll(),!this.isControlled){var disabledMonths=this.disabledMonths(),selectedMonths=monthNumbers.filter((function(m){return!disabledMonths.includes(m)}));this.setState({selectedMonths:selectedMonths})}}},{key:"handleClearAll",value:function handleClearAll(){this.props.onClearAll&&this.props.onClearAll(),this.isControlled||this.setState({selectedMonths:[]})}},{key:"renderMonths",value:function renderMonths(){var _this2=this,selectedMonths=this.selectedMonths(),disabledMonths=this.disabledMonths(),_props=this.props,name=_props.name,inversed=_props.inversed;return _react2.default.createElement("ol",{className:"ds-c-list--bare ds-u-display--flex ds-u-justify-content--between ds-u-flex-wrap--wrap"},this.months.map((function(month,i){return _react2.default.createElement("li",{key:month},_react2.default.createElement(_Choice2.default,{"aria-describedby":_this2.props.hint?_this2.hintId:null,"aria-label":_this2.monthsLong[i],checked:selectedMonths.includes(i+1),className:"ds-c-month-picker__month",disabled:disabledMonths.includes(i+1),inversed:inversed,onChange:function onChange(e){return _this2.handleChange(e)},name:name,value:i+1},month))})))}},{key:"renderButton",value:function renderButton(text,pressed,onClick){return _react2.default.createElement(_Button2.default,{"aria-describedby":this.labelId,"aria-pressed":pressed,size:"small",className:"ds-u-margin-right--1",onClick:onClick,inversed:this.props.inversed,variation:this.props.buttonVariation},text)}},{key:"renderLabel",value:function renderLabel(){var classes=(0,_classnames2.default)("ds-u-font-weight--bold",this.props.labelClassName);return _react2.default.createElement(_FormLabel2.default,{className:"ds-u-visibility--screen-reader",labelClassName:classes,component:"legend",errorMessage:this.props.errorMessage,requirementLabel:this.props.requirementLabel,inversed:this.props.inversed},this.props.label)}},{key:"render",value:function render(){var _this3=this,_props2=this.props,selectAllText=_props2.selectAllText,clearAllText=_props2.clearAllText,selectedMonths=this.selectedMonths(),disabledMonths=this.disabledMonths(),selectAllPressed=selectedMonths.length===NUM_MONTHS-disabledMonths.length,clearAllPressed=0===selectedMonths.length,Heading=this.props.headingLevel?"h"+this.props.headingLevel:"h4",classes=(0,_classnames2.default)("ds-c-month-picker","ds-c-fieldset","ds-u-margin-y--3",this.props.className);return _react2.default.createElement("div",{className:classes},_react2.default.createElement("div",null,_react2.default.createElement(Heading,{className:"ds-c-label ds-u-font-weight--bold ds-u-margin--0",id:this.labelId},this.props.label),this.props.hint?_react2.default.createElement("p",{className:"ds-c-label ds-c-field__hint ds-u-margin--0",id:this.hintId},this.props.hint):null),_react2.default.createElement("div",{className:"ds-u-margin-top--3"},this.renderButton(selectAllText,selectAllPressed,(function(){return _this3.handleSelectAll()})),this.renderButton(clearAllText,clearAllPressed,(function(){return _this3.handleClearAll()}))),_react2.default.createElement("fieldset",{className:"ds-c-fieldset"},this.renderLabel(),_react2.default.createElement("div",{className:"ds-c-month-picker__months"},this.renderMonths())))}}]),MonthPicker}();function getMonthNames(locale){for(var short=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],options={month:short?"short":"long"},months=[],i=0;i<NUM_MONTHS;i++){var date=new Date;date.setMonth(i,1),months.push(date.toLocaleString(locale,options))}return months}MonthPicker.defaultProps={selectAllText:"Select all",clearAllText:"Clear all"},MonthPicker.propTypes={name:_propTypes2.default.string.isRequired,locale:_propTypes2.default.string,className:_propTypes2.default.string,inversed:_propTypes2.default.bool,buttonVariation:_propTypes2.default.string,label:_propTypes2.default.node.isRequired,labelClassName:_propTypes2.default.string,errorMessage:_propTypes2.default.node,hint:_propTypes2.default.node,headingLevel:_propTypes2.default.number,requirementLabel:_propTypes2.default.node,disabledMonths:_propTypes2.default.arrayOf(_propTypes2.default.number),selectedMonths:_propTypes2.default.arrayOf(_propTypes2.default.number),defaultSelectedMonths:_propTypes2.default.arrayOf(_propTypes2.default.number),onChange:_propTypes2.default.func,onSelectAll:_propTypes2.default.func,onClearAll:_propTypes2.default.func,selectAllText:_propTypes2.default.string.isRequired,clearAllText:_propTypes2.default.string.isRequired},exports.default=MonthPicker;